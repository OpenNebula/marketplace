---
name: K3s 1.17
version: 1.17.17-5.12.0.2-20210621
publisher: OpenNebula Systems
description: |-
  Image with preinstalled K3s binary.

  **IMPORTANT**: Firecracker VM requires [Kernel 4.19](/appliance/ba40d522-8739-11eb-8dcd-0242ac130003). Don't forget to import it as well and update K3s VM template to point to this kernel (see `KERNEL_DS = "$FILE[IMAGE_ID=<USER_ADD>]"`).
short_description: Image with preinstalled K3s 1.17
tags:
- k3s
- ubuntu
format: raw
creation_time: 1624269995
os-id: Ubuntu
os-release: '18.04'
os-arch: x86_64
hypervisor: FIRECRACKER
opennebula_version: 5.13, 6.0, 6.1
logo: k3s.png
opennebula_template:
  context:
    k3s_dns_enable: "$K3S_DNS_ENABLE"
    k3s_flannel_backend: "$K3S_FLANNEL_BACKEND"
    k3s_ingress_enable: "$K3S_INGRESS_ENABLE"
    k3s_lb_enable: "$K3S_LB_ENABLE"
    k3s_role: "$K3S_ROLE"
    k3s_version: "$K3S_VERSION"
    rancher_access_key: "$RANCHER_ACCESS_KEY"
    rancher_auto_registration_enable: "$RANCHER_AUTO_REGISTRATION_ENABLE"
    rancher_secret_key: "$RANCHER_SECRET_KEY"
    rancher_url: "$RANCHER_URL"
    network: "YES"
    set_hostname: "k3s-$K3S_ROLE-$VMID"
    ssh_public_key: "$USER[SSH_PUBLIC_KEY]"
    start_script_base64: 'cmFuY2hlcl9hdXRvX3JlZ2lzdHJhdGlvbigpIHsKICAjIGRvd25sb2FkIGF1dG9yZWdpc3RyYXRpb24geWFtbCBmaWxlCiAgd2dldCAtTyAvdG1wL2F1dG9yZWdpc3Rlci55YW1sIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9GdWxsU3RhY2tTLUdtYkgvazNzLXJhbmNoZXItYXV0b3JlZ2lzdGVyL21haW4vbWFuaWZlc3QvYXV0b3JlZ2lzdGVyLnlhbWwKCiAgc2VkIC1pIC1lICJzJ1JBTkNIRVJfQVBJX0VORFBPSU5UOidSQU5DSEVSX0FQSV9FTkRQT0lOVDogJFJBTkNIRVJfVVJMJyIgL3RtcC9hdXRvcmVnaXN0ZXIueWFtbAogIHNlZCAtaSAtZSAicydDQVRUTEVfQUNDRVNTX0tFWTonQ0FUVExFX0FDQ0VTU19LRVk6ICRSQU5DSEVSX0FDQ0VTU19LRVknIiAvdG1wL2F1dG9yZWdpc3Rlci55YW1sCiAgc2VkIC1pIC1lICJzJ0NBVFRMRV9TRUNSRVRfS0VZOidDQVRUTEVfU0VDUkVUX0tFWTogJFJBTkNIRVJfU0VDUkVUX0tFWSciIC90bXAvYXV0b3JlZ2lzdGVyLnlhbWwKCiAgd2hpbGUgW1sgISAtZCAvdmFyL2xpYi9yYW5jaGVyL2szcy9zZXJ2ZXIvbWFuaWZlc3RzLyBdXTsgZG8gc2xlZXAgMjsgZG9uZQogIGNwIC90bXAvYXV0b3JlZ2lzdGVyLnlhbWwgL3Zhci9saWIvcmFuY2hlci9rM3Mvc2VydmVyL21hbmlmZXN0cy8KfQoKc3RhcnRfc2VydmVyICgpIHsKICAjIHNldCBLM3Mgc2VydmVyIG9wdGlvbnMKICBbWyAke0VYVEVSTkFMX0lQfSAhPSAibnVsbCIgXV0gJiYgSzNTX0VYVEVSTkFMX0lQPSItLW5vZGUtZXh0ZXJuYWwtaXAgJHtFWFRFUk5BTF9JUH0iCiAgW1sgJHtFWFRFUk5BTF9JUH0gIT0gIm51bGwiIF1dICYmIEszU19UTFNfU0FOPSItLXRscy1zYW4gJHtFWFRFUk5BTF9JUH0iCiAgSzNTX0tVQkVDT05GSUdfTU9ERT0iLS13cml0ZS1rdWJlY29uZmlnLW1vZGUgNjAwIgogIEszU19DTkk9Ii0tZmxhbm5lbC1iYWNrZW5kPSR7SzNTX0ZMQU5ORUxfQkFDS0VORH0iCiAgSzNTX0xPRz0iLS1sb2cgL3RtcC9rM3MubG9nIgogIEszU19TVE9SQUdFPSItLWRlZmF1bHQtbG9jYWwtc3RvcmFnZS1wYXRoIC90bXAvazNzLXN0b3JhZ2UiCiAgW1sgJHtLM1NfSU5HUkVTU19FTkFCTEV9ID09ICJOTyIgXV0gJiYgSzNTX1RSQUVGSUs9Ii0tbm8tZGVwbG95IHRyYWVmaWsiCiAgW1sgJHtLM1NfRE5TX0VOQUJMRX0gPT0gIk5PIiBdXSAmJiBLM1NfQ09SRUROUz0iLS1kaXNhYmxlIGNvcmVkbnMiCiAgW1sgJHtLM1NfTEJfRU5BQkxFfSA9PSAiTk8iIF1dICYmIEszU19MQj0iLS1kaXNhYmxlIHNlcnZpY2VsYiIKCiAgSzNTX09QVFM9IiR7SzNTX0VYVEVSTkFMX0lQfSAke0szU19UTFNfU0FOfSAke0szU19LVUJFQ09ORklHX01PREV9ICR7SzNTX0NOSX0gJHtLM1NfTE9HfSAke0szU19TVE9SQUdFfSAke0szU19UUkFFRklLfSAke0szU19DT1JFRE5TfSAke0szU19MQn0iCgogICMgcnVuIEszcyBzZXJ2ZXIKICBub2h1cCBrM3Mgc2VydmVyICR7SzNTX09QVFN9ID4gL2Rldi9udWxsICYKCiAgIyBjaGVjayB0b2tlbiBmaWxlCiAgd2hpbGUgW1sgISAtZiAvdmFyL2xpYi9yYW5jaGVyL2szcy9zZXJ2ZXIvdG9rZW4gXV07IGRvIHNsZWVwIDI7IGRvbmUKCiAgIyB1cGRhdGUgVk0gbWV0YWRhdGEgd2l0aCB0b2tlbgogIG9uZWdhdGUgdm0gdXBkYXRlIC0tZGF0YSBLM1NfVE9LRU49JChjYXQgL3Zhci9saWIvcmFuY2hlci9rM3Mvc2VydmVyL3Rva2VuKQp9CgpzdGFydF9hZ2VudCAoKSB7CiAgSzNTX1NFUlZFUl9JRD0kKG9uZWdhdGUgc2VydmljZSBzaG93IC0tanNvbiB8IGpxICcuU0VSVklDRS5yb2xlc1tdIHwgc2VsZWN0KC5uYW1lPT0gInNlcnZlciIpIHwgLm5vZGVzWzBdLnZtX2luZm8uVk0uSUQnIHwgc2VkIC1lICdzL14iLy8nIC1lICdzLyIkLy8nKQogIEszU19TRVJWRVJfSVA9JChvbmVnYXRlIHZtIHNob3cgJHtLM1NfU0VSVkVSX0lEfSAtLWpzb24gfCBqcSAuVk0uVEVNUExBVEUuTklDWzBdLkVYVEVSTkFMX0lQIHwgc2VkIC1lICdzL14iLy8nIC1lICdzLyIkLy8nKQogIFtbICR7SzNTX1NFUlZFUl9JUH0gPT0gIm51bGwiIF1dICYmIEszU19TRVJWRVJfSVA9JChvbmVnYXRlIHZtIHNob3cgJHtLM1NfU0VSVkVSX0lEfSAtLWpzb24gfCBqcSAuVk0uVEVNUExBVEUuTklDWzBdLklQIHwgc2VkIC1lICdzL14iLy8nIC1lICdzLyIkLy8nKQogIEszU19UT0tFTj0kKG9uZWdhdGUgdm0gc2hvdyAke0szU19TRVJWRVJfSUR9IC0tanNvbiB8IGpxIC5WTS5VU0VSX1RFTVBMQVRFLkszU19UT0tFTiB8IHNlZCAtZSAncy9eIi8vJyAtZSAncy8iJC8vJykKICBLM1NfVVJMPSJodHRwczovLyR7SzNTX1NFUlZFUl9JUH06NjQ0MyIKCiAgW1sgJHtFWFRFUk5BTF9JUH0gIT0gIm51bGwiIF1dICYmIEszU19FWFRFUk5BTF9JUD0iLS1ub2RlLWV4dGVybmFsLWlwICR7RVhURVJOQUxfSVB9IgoKIyBzZXQgSzNzIGFnZW50IG9wdGlvbnMKICBLM1NfT1BUUz0iJHtLM1NfRVhURVJOQUxfSVB9IC0tdG9rZW4gJHtLM1NfVE9LRU59IC0tc2VydmVyICR7SzNTX1VSTH0gLS1sb2cgL3RtcC9rM3NfYWdlbnQubG9nIgoKIyBydW4gSzNzIGFnZW50CiAgbm9odXAgazNzIGFnZW50ICR7SzNTX09QVFN9ID4gL2Rldi9udWxsICYKfQoKIyBtb3VudCBjb250ZXh0Cm1vdW50IC1MIENPTlRFWFQgL21udAoKIyBleHBvcnQgSzNTIHZhcmlhYmxlcwpleHBvcnQgJChncmVwIEszUyAvbW50L2NvbnRleHQuc2ggfCBzZWQgLWUgInMvJy8vZyIpCgojIGV4cG9ydCBSQU5DSEVSIHZhcmlhYmxlcwpleHBvcnQgJChncmVwIFJBTkNIRVIgL21udC9jb250ZXh0LnNoIHwgc2VkIC1lICJzLycvL2ciKQoKIyBkb3dubG9hZCBLM3MKd2dldCAtLW5vLWNoZWNrLWNlcnRpZmljYXRlIC1PIC91c3IvbG9jYWwvYmluL2szcyBodHRwczovL2dpdGh1Yi5jb20vazNzLWlvL2szcy9yZWxlYXNlcy9kb3dubG9hZC8ke0szU19WRVJTSU9OfS9rM3MgJiYgY2htb2QgNzU1IC91c3IvbG9jYWwvYmluL2szcwoKIyBzZXQgSE9TVCBJUCBhbmQgL2V0Yy9ob3N0cwpIT1NUX0lQPSQob25lZ2F0ZSB2bSBzaG93IC0tanNvbiB8IGpxIC5WTS5URU1QTEFURS5OSUNbMF0uSVAgfCBzZWQgLWUgJ3MvXiIvLycgLWUgJ3MvIiQvLycpCkVYVEVSTkFMX0lQPSQob25lZ2F0ZSB2bSBzaG93IC0tanNvbiB8IGpxIC5WTS5URU1QTEFURS5OSUNbMF0uRVhURVJOQUxfSVAgfCBzZWQgLWUgJ3MvXiIvLycgLWUgJ3MvIiQvLycpCgppcCBhZGRyIGFkZCAke0VYVEVSTkFMX0lQfSBkZXYgbG8KCkhPU1ROQU1FPSQoaG9zdG5hbWUpCgpjYXQgPiAvZXRjL2hvc3RzIDw8IEVPRgoxMjcuMC4wLjEgbG9jYWxob3N0CiR7SE9TVF9JUH0gJHtIT1NUTkFNRX0KRU9GCgojIHN0YXJ0IGszcwppZiBbICR7SzNTX1JPTEV9ID09ICJhZ2VudCIgXTsgdGhlbgogICAgc3RhcnRfYWdlbnQKZWxzZQogICAgc3RhcnRfc2VydmVyCiAgICAjIHJhbmNoZXIgYXV0byByZWdpc3RyYXRpb24KICAgIFtbICR7UkFOQ0hFUl9BVVRPX1JFR0lTVFJBVElPTl9FTkFCTEV9ID09ICJZRVMiIF1dICYmIHJhbmNoZXJfYXV0b19yZWdpc3RyYXRpb24KZmkKCiMgc2V0IFZNIFJlYWR5Cm9uZWdhdGUgdm0gdXBkYXRlIC0tZGF0YSBSRUFEWT1ZRVMKCnVtb3VudCAvbW50'
    token: "YES"
  cpu: "1"
  graphics:
    listen: "0.0.0.0"
    type: "VNC"
  memory: "2048"
  nic:
    network_mode: "auto"
  os:
    boot: ""
    kernel_cmd: "console=ttyS0 reboot=k panic=1 pci=off i8042.noaux i8042.nomux i8042.nopnp i8042.dumbkbd"
    kernel_ds: "$FILE[IMAGE_ID=<USER_ADD>]"
  sched_requirements: "CLUSTER=\"$EDGE_LOCATION\""
  inputs_order: "EDGE_LOCATION,K3S_VERSION,K3S_DNS_ENABLE,K3S_INGRESS_ENABLE,K3S_LB_ENABLE,K3S_FLANNEL_BACKEND"
  vcpu: "2"
images:
- name: k3s
  url: https://d24fmfybwxpuhu.cloudfront.net/k3s-1.17.17-5.12.0.2.raw.gz
  type: OS
  dev_prefix: vd
  driver: raw
  size: 2147483648
  checksum:
    md5: 0387488c90f49bf79edbc95f2135ac15
    sha256: 78904e39966530aa05207a33c066881c3c3490f806798bacb6cb11f62dea569d
